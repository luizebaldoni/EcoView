{% extends "base.html" %}

{% block content %}
<h1 class="mb-4"><i class="bi bi-table me-2"></i>Todos os Dados dos Sensores</h1>

<div class="table-responsive mb-4">
    <table class="table table-striped table-hover">
        <thead class="table-success">
            <tr>
                <th>Data/Hora</th>
                <th>Temp 1 (°C)</th>
                <th>Temp 2 (°C)</th>
                <th>Umidade 1 (%)</th>
                <th>UV 1</th>
                <th>Vento 1 (m/s)</th>
                <th>Bateria (%)</th>
                <th>Dispositivo</th>
            </tr>
        </thead>
        <tbody>
            {% for reading in page_obj %}
            <tr>
                <td>{{ reading.timestamp|date:"d/m/Y H:i" }}</td>
                <td>{{ reading.sensor1|floatformat:1 }}</td>
                <td>{{ reading.sensor2|floatformat:1 }}</td>
                <td>{{ reading.sensor7|floatformat:1 }}</td>
                <td>{{ reading.sensor10|floatformat:1 }}</td>
                <td>{{ reading.sensor12|floatformat:1 }}</td>
                <td>
                    <div class="progress" style="height: 20px;">
                        <div class="progress-bar bg-success" role="progressbar"
                             style="width: {{ reading.battery_level }}%"
                             aria-valuenow="{{ reading.battery_level }}"
                             aria-valuemin="0"
                             aria-valuemax="100">
                            {{ reading.battery_level }}%
                        </div>
                    </div>
                </td>
                <td>{{ reading.device_id|truncatechars:8|default:"N/A" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page=1" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        {% endif %}

        <li class="page-item disabled">
            <span class="page-link">
                Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
            </span>
        </li>

        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
        {% endif %}
    </ul>
</nav>

<div class="d-flex justify-content-between mt-4">
    <a href="{% url 'dashboard' %}" class="btn btn-success">
        <i class="bi bi-speedometer2 me-1"></i>Voltar ao Dashboard
    </a>
    <span class="text-muted">Total de registros: {{ page_obj.paginator.count }}</span>
</div>
{% endblock %}